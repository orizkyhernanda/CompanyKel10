"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const mongoose = require("mongoose");
/**
 * Will setup the mongoose connection,
 * and ensure mongoose uses ES5 promises
 *
 * @module      config/db
 * @function    setupMongoose
 * */
function setupMongoose(config) {
    return new Promise((rsv, rr) => {
        mongoose.Promise = global.Promise; // TODO:ffl - Don't work as expected
        mongoose.connect(`mongodb://${!!(config.username && config.pwd) ? (config.username + ':' + config.pwd + '@') : ''}${config.domain || 'localhost'}:${config.port || 27017}/${config.database}`);
        const db = mongoose.connection;
        db.on('error', (err) => rr(err));
        db.on('connection', () => rsv(db));
    });
}
exports.setupMongoose = setupMongoose;
exports.onConnectionSuccess = () => {
    console.log('Successfully connected to database');
};
exports.onConnectionError = (err) => {
    console.error(err);
};
