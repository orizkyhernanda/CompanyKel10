"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const jwt = require("jsonwebtoken");
class JWT {
    constructor(secret, ttl = null) {
        this.secret = secret;
        this.ttl = ttl;
    }
    create(sub) {
        return jwt.sign({ data: sub }, this.secret, this.ttl ? { expiresIn: this.ttl } : {});
    }
    verify(token) {
        return new Promise((rsv, rr) => {
            jwt.verify(token, this.secret, (err, decoded) => {
                if (err) {
                    return rr(err);
                }
                rsv(decoded);
            });
        });
    }
}
exports.default = JWT;
